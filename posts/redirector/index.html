<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>colonelpopcorn/redirector - colonelpopcorn writes software</title><meta name=description content="Redirector I began this project when I realized that I couldn't redirect to another URL with Traefik. I wanted my users to go to plex.mydomain.net and end up at media.mydomain.net instead. Turns out you can&amp;rsquo;t do that with typical HTTP server configurations, and Traefik was no different. I decided it would be easy enough to build my own solution using a minimal Node.js web server. My solution to the problem was to forward all requests that ended in a 404 HTTP status code to a container."><meta name=robots content="noodp"><link rel=canonical href=https://colonelpopcorn.github.io/posts/redirector/><meta name=twitter:card content="summary"><meta name=twitter:description content="Redirector I began this project when I realized that I couldn't redirect to another URL with Traefik. I wanted my users to go to plex.mydomain.net and end up at media.mydomain.net instead. Turns out you can&amp;rsquo;t do that with typical HTTP server configurations, and Traefik was no different. I decided it would be easy enough to build my own solution using a minimal Node.js web server. My solution to the problem was to forward all requests that ended in a 404 HTTP status code to a container."><meta name=twitter:title content="colonelpopcorn/redirector - colonelpopcorn writes software"><meta name=twitter:site content="http://twitter.com/bul_ikana"><meta name=twitter:creator content="http://twitter.com/bul_ikana"><meta property="og:type" content="article"><meta content="colonelpopcorn/redirector - colonelpopcorn writes software" property="og:title"><meta content="Redirector I began this project when I realized that I couldn't redirect to another URL with Traefik. I wanted my users to go to plex.mydomain.net and end up at media.mydomain.net instead. Turns out you can&amp;rsquo;t do that with typical HTTP server configurations, and Traefik was no different. I decided it would be easy enough to build my own solution using a minimal Node.js web server. My solution to the problem was to forward all requests that ended in a 404 HTTP status code to a container." property="og:description"><meta property="og:url" content="https://colonelpopcorn.github.io/posts/redirector/"><meta property="og:site_name" content="colonelpopcorn writes software"><meta property="article:published_time" content="2023-10-18 15:41:43 -0400 -0400"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"colonelpopcorn\/redirector","genre":"","url":"https:\/\/colonelpopcorn.github.io\/posts\/redirector\/","datePublished":"2023-10-18 15:41:43 -0400 -0400","description":"Redirector I began this project when I realized that I couldn\u0027t redirect to another URL with Traefik. I wanted my users to go to plex.mydomain.net and end up at media.mydomain.net instead. Turns out you can\u0026rsquo;t do that with typical HTTP server configurations, and Traefik was no different. I decided it would be easy enough to build my own solution using a minimal Node.js web server. My solution to the problem was to forward all requests that ended in a 404 HTTP status code to a container.","author":{"@type":"Person","name":""}}</script><link rel=stylesheet href=/sass/main.css><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href=/css/custom.css></head><body><header class=site-header><nav class="navbar navbar-default"><div class=container-fluid><div class=navbar-header><button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#bs-example-navbar-collapse-1 aria-expanded=false>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button>
<a class=navbar-brand href=https://colonelpopcorn.github.io>colonelpopcorn writes software</a></div><div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1><ul class="nav navbar-nav navbar-right"><li><a href=https://colonelpopcorn.github.iopages/about/>About</a></li><li><a href=https://colonelpopcorn.github.iopages/contact/>Contact</a></li><li class=dropdown><a href=# class=dropdown-toggle data-toggle=dropdown role=button aria-haspopup=true aria-expanded=false>Download <span class=caret></span></a><ul class=dropdown-menu><li><a target=_blank href=https://github.com/bul-ikana/hugo-cards>Project</a></li><li><a href=https://github.com/bul-ikana/hugo-cards.git>Download</a></li><li role=separator class=divider></li><li><a target=_blank href=https://themes.gohugo.io/>More Themes</a></li></ul></li></ul></div></div></nav></header><div class=container><div class=wrapper><div class=row><div class=col-md-8><article class=post itemscope itemtype=http://schema.org/BlogPosting><header class=post-header><h1 class=post-title itemprop="name headline">colonelpopcorn/redirector</h1><p class=post-meta><time datetime=2023-10-18T15:41:43-04:00 itemprop=datePublished>October 18, 2023</time></p></header><div class=post-content itemprop=articleBody><h2 id=redirectorhttpsgitlabcomcolonelpopcornredirector><a href=https://gitlab.com/colonelpopcorn/redirector>Redirector</a></h2><p>I began this project when I realized that I couldn't redirect to another URL with Traefik. I wanted my users to go to <code>plex.mydomain.net</code> and end up at <code>media.mydomain.net</code> instead. Turns out you can&rsquo;t do that with typical HTTP server configurations, and Traefik was no different. I decided it would be easy enough to build my own solution using a minimal Node.js web server. My solution to the problem was to forward all requests that ended in a 404 HTTP status code to a container. Said container then would lookup a URL in a configuration map based on the domain that threw the 404. Finally, the looked up URL was injected into an HTML template with a deferred <code>script</code> tag that finally redirected the user to the looked up URL. All this with a little bit of animation to provide the user some feedback.</p><p>I had a few more requirements before I got started on the project. I knew I didn&rsquo;t want the maintenance headache inherent in any <code>express.js</code> project. Dependabot is great, but its ubiquity and the ubiquity of Node security research mean I would have no rest from running <code>npm audit</code>. I found <code>urest</code> which promised a zero dependency framework with some amount of <code>express.js</code> compatibility. I also knew I wanted to be able to update the config without having to rebuild the docker image.</p><p>Ultimately, I ran the project for a very limited time. My code to persist the configuration didn&rsquo;t work and any container restarts caused all configuration to be lost. In the future, I&rsquo;m going to use Traefik&rsquo;s 404 handling and a static page to achieve the same thing. It will require a rebuild of the page, but it&rsquo;s an easy enough to automate a template and an SCP command to put the file where it needs to go.</p></div></article><div class=row></div><div class=row><ul class=pager><li><a class=previous href=https://colonelpopcorn.github.io/posts/raddock/>colonelpopcorn/RadDock &#187;</a></li></ul></div></div><div class="col-md-4 mt20"><div class=post-img><img width=100% src=/posts/redirector/cover.jpeg alt=cover.jpeg></div><div class="mt10 recent"><h2>Recent articles</h2><ul><li><p><a href=https://colonelpopcorn.github.io/posts/redirector/>colonelpopcorn/redirector</a><small>&nbsp;&nbsp;October 18, 2023</small></p></li><li><p><a href=https://colonelpopcorn.github.io/posts/raddock/>colonelpopcorn/RadDock</a><small>&nbsp;&nbsp;March 23, 2021</small></p></li><li><p><a href=https://colonelpopcorn.github.io/posts/generator-osticket/>colonelpopcorn/generator-osticket</a><small>&nbsp;&nbsp;February 25, 2017</small></p></li></ul></div><br></div></div></div></div><footer><div class=container><div class="row p20"><div class="col-md-4 text-center mt25">All rights reserved by <a target=_blank href=https://bool.netlify.com>bool</a></div><div class="col-md-4 text-center mt25"><a target=_blank href=https://bool.netlify.com><img src=https://img.shields.io/badge/Built%20by-bool-brightgreen.svg alt=bool></a></div><div class="col-md-4 text-center mt25"><a target=_blank href=http://twitter.com/bul_ikana><li class="social twitter"><i class="fa fa-twitter-square"></i></li></a><a target=_blank href=http://github.com/bul-ikana><li class="social github"><i class="fa fa-github-square"></i></li></a></div></div></div></footer><script src=https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js></script><script src=https://colonelpopcorn.github.io/js/bootstrap.min.js></script></body></html>